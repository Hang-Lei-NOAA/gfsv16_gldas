      SUBROUTINE SPCHK(IXL,JXL,IAPT,IPANA,IPANY,IVARY)
C  ROUTINE TO CHECK FOR 2 OR MORE CONSECUTIVE SPACES IN A TITLE STRING  00301500
C  ON A VARIAN/FAX PEPFAX CHART. IF CONSECUTIVE SPACES ARE FOUND, THE   00301600
C  REMAINDER OF THE TITLE IS MOVED TO THE LEFT. THE HOPE IS TO HAVE     00301700
C  ENOUGH SPACE TO FIT THE NOAA TEXT ID IN THE TITLE OF THE CHART       00301800
C  (RIGHT-JUSTIFIED) 7/25/85 DAVE HORN.                                 00301900
C  MODIFIED 7/26/85 SO DUCKLING IS PUT ON PANEL CHARTS APPROPRIATELY    00302000
C  MODIFIED 7/30/85 TO USE KEVIN'S DUCK24 ROUTINE TO FIT 24-DOT         00302100
C  DUCKLING IN TITLES ON ONE PANEL CHARTS AND IN 2 & 4 PANEL CHARTS     00302200
C  MODIFIED 7/31/85 TO JUST PUT ON 24-DOT DUCKLING ON WEFAX CHARTS      00302300
C  MODIFIED 8/07/85 TO INCLUDE TESTS FOR TITLE BEING TOO LONG TO FIT ON 00302400
C  24-DOT DUCKLING BUT SHORT ENOUGH TO PUT ON TEXT ID.                  00302500
C  AT THE REQUEST OF MR. HOWCROFT, MODIFIED MULTIPLE PANEL CHARTS ON    00302600
C  8/23/85 TO CENTER NOAA TEXT ID ON THESE CHARTS--NO 24-DOT DUCKLING.  00302700
C ********************************************************************* 00302800
C  THIS SUBROUTINE MODIFIED ON 10/16/85 TO WORK FOR MERCFAX             00302900
C ********************************************************************* 00303000
      COMMON/CRUNCH/IBCD2(40)
      CHARACTER*1 LBCD(200),LBLNK,LDL
c      LOGICAL   LBCD(200),LBLNK/' '/,LDL/'$'/                           00303200
      data lblnk,ldl/' ','$'/
      EQUIVALENCE (IBCD2(1),LBCD(1))
      DATA IPANC/'P1  '/,IPANB/'P3  '/
C CHECK TO SEE IF WE HAVE A PANEL CHART TO DEAL WITH                    00303500
        IF(IPANA.EQ.IPANC.OR.IPANA.EQ.IPANB) GO TO 30
        IF(IPANY.EQ.1) RETURN
C  INITIALIZATION OF TITLE VARIABLES FOR ONE-PANEL AND WEFAX CHARTS     00303800
        MNDSTR = 140
        IF(IVARY.EQ.1) MNDSTR = 86
        IF(IAPT.EQ.1) MNDSTR = 83
        INDSTR = 130
        IF(IVARY.EQ.1) INDSTR = 80
        IF(IAPT.EQ.1) INDSTR = 77
        ITITLL = 1260
        IF(IVARY.NE.1) ITITLL = 1475
        ISTRL1 = 98
        IF(IVARY.EQ.1)ISTRL1 = 74
        ISTRL2 = 95
        IF(IVARY.EQ.1)ISTRL2 = 69
C  FIND THE CONSECUTIVE SPACES                                          00305100
        LBCD(INDSTR) = LDL
        IB2 = 0
 10     IB2 = IB2 + 1
        IF(LBCD(IB2).EQ.LDL) GO TO 20
        IF(LBCD(IB2).NE.LBLNK.OR.LBCD(IB2+1).NE.LBLNK) GO TO 10
C  MOVE TITLE OVER IF FIND 2 CONSECUTIVE BLANKS                         00305700
 13        DO 12 IB3 = IB2,MNDSTR
             LBCD(IB3) = LBCD(IB3+1)
 12        CONTINUE
C  WE MAY HAVE MORE CONSECUTIVE BLANKS LET'S GO BACK AND CHECK          00306100
         IF(LBCD(IB2).EQ.LBLNK.AND.LBCD(IB2+1).EQ.LBLNK) GO TO 13
         GO TO 10
C 1200 IS LENGTH IN DOTS OF TITLE WITH 84 CHARACTERS (CHARACTER SET 11) 00306400
C TO RIGHT JUSTIFY THE NOAA TEXT ID AND 24-DOT DUCKLING IN THE TITLE,   00306500
C SUBTRACT 197 DOTS (WHICH IS THE LENGTH OF THE DUCKLING AND TEXT       00306600
C TOGETHER), THEN ADD THE "I" PORTION OF THE ORIGIN OF THE TITLE SO     00306700
C THE 24-DOT DUCKLING STARTS IN THE RIGHT PLACE. ONLY PUT 24-DOT        00306800
C DUCKLING ON WEFAX CHARTS.                                             00306900
 20   IF(IAPT .NE. 1) GO TO 25
C ID ASSOCIATED WITH WEFAX TITLES                                       00307100
      WRITE(6,100)(LBCD(I),I=1,84)
      IF(IB2 .LT. 70) GO TO 21
      WRITE(6,120) IB2
 120  FORMAT(1X,'THE NUMBER OF CHARACTERS IN THE WEFAX TITLE IS',I3,
     &' AND THAT"S TOO LONG TO FIT IN THE 30-DOT DUCKLING')
      RETURN
 21   CALL DUCK(720,JXL,0,9)
      WRITE(6,121) JXL
 121  FORMAT(1X,'30-DOT EMBLEM PUT ON WEFAX CHART AT I,J= 720',',',I4)
      RETURN
C ID ASSOCIATED WITH ANY ONE-PANEL CHARTS                               00308200
 25   IF(IB2.LT.ISTRL1) GO TO 26
        WRITE(6,110) IB2
 110    FORMAT(1X,'THE NUMBER OF CHARACTERS IN THE TITLE IS',I3,' AND
     &THAT"S TOO LONG TO FIT IN THE DUCKLING AND/OR NOAA TEXT ID')
      RETURN
 26   WRITE(6,100)(LBCD(I),I=1,84)
 100  FORMAT(1X,'TITLE WITHOUT EXCESS BLANKS: ',84A1)
        IXT = ITITLL - 197 + IXL
      IF(IB2.GT.ISTRL2) GO TO 27
        WRITE(6,101) IXT,JXL
 101  FORMAT(1X,'30-DOT DUCKLING AND NOAA TEXT ID PUT ON ONE-PANEL CHART
     & AT I,J= ',I4,',',I4)
C  PUT ON THE 24-DOT DUCKLING AND TEXT ID                               00309500
        CALL DUCK(IXT,JXL,0,7)
        RETURN
C  THERE IS ONLY ROOM TO PUT ON NOAA TEXT ID ON ONE-PANEL CHART         00309800
 27     IXT = IXT + 35
        WRITE(6,102) IXT,JXL
 102  FORMAT(1X,'TEXT ID PUT ON ONE-PANEL CHART AT I,J= ',I4,',',I4)
        CALL DUCK(IXT,JXL,0,8)
        RETURN
C TO GET THE 'I' LOCATION OF THE DUCKLING FOR PANEL CHARTS: 895 DOTS    00310400
C WOULD BE A POSITION IN THE CENTER OF THE TWO PANELS, SUBTRACT 15 DOTS 00310500
C TO OBTAIN THE 'I' ORIGIN OF THE DUCKLING. SUBTRACT 3 DOTS FROM JXL TO 00310600
C VERTICALLY CHOP OFF THE DUCKLING NICELY.                              00310700
C NOTE, NO NEED TO SUBTRACT 3 DOTS FROM JXL SINCE HAVE 24-DOT DUCKLING. 00310800
C ONLY PUTTING ON THE NOAA TEXT ID CENTERED ON THE CHART--NO 24-DOT     00310900
C DUCKLING. SUBTRACT 120 DOTS TO CENTER NOAA TEXT ID.                   00311000
 30     IXT = 900 - 120
        IF(IPANA .EQ. IPANB) IPTYPE = 4
        IF(IPANA .EQ. IPANC) IPTYPE = 2
        WRITE(6,130) IPTYPE,JXL
 130    FORMAT(1X,'NOAA TEXT ID CENTERED BETWEEN PANELS ON A',I2,' PANEL
     & CHART AT I,J= 780',',',I4)
        CALL DUCK(IXT,JXL,0,8)
        RETURN
        END
