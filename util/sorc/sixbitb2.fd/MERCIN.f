      SUBROUTINE MERCIN(ISWTCH,NUMF,MAPON,NSLOTS,ILVLI,
     1     IFLDI,ITAUI,ICODIN,INAMIN,IOUTIN,IINFA,IINFB)
C $$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    MERCIN      INPUT FIELD READER
C   PRGMMR: KRISHNA KUMAR          ORG: W/NP12   DATE: 1999-09-25
C
C ABSTRACT: BASIC MAP CONTROL.
C
C PROGRAM HISTORY LOG:
C   ??-??-??  UNKNOWN
C   91-02-21  STEVE LILLY, MODIFIED ROUTINE AND ADDED DOC BLOCK.
C   95-05-05  LILLY  CONVRT SUBROUTINE TO FORTRAN 77.
C 1999-09-25  KRISHNA KUMAR CONVERTED THIS CODE FROM CRAY TO IBM SP/6000
C
C USAGE:    CALL MERCIN(ISWTCH,NUMF,MAPON,NSLOTS,ILVLI,IFLD1,ITAUI,
C                       ICODIN,INAMIN,IOUTIN, IINFA,IINFB)
C   INPUT ARGUMENT LIST:
C     INARG1   - GENERIC DESCRIPTION, INCLUDING CONTENT, UNITS,
C     INARG2   - TYPE.  EXPLAIN FUNCTION IF CONTROL VARIABLE.
C
C   OUTPUT ARGUMENT LIST:      (INCLUDING WORK ARRAYS)
C     WRKARG   - GENERIC DESCRIPTION, ETC., AS ABOVE.
C     OUTARG1  - EXPLAIN COMPLETELY IF ERROR RETURN
C     ERRFLAG  - EVEN IF MANY LINES ARE NEEDED
C
C   INPUT FILES:   (DELETE IF NO INPUT FILES IN SUBPROGRAM)
C     DDNAME1  - GENERIC NAME & CONTENT
C
C   OUTPUT FILES:  (DELETE IF NO OUTPUT FILES IN SUBPROGRAM)
C     DDNAME2  - GENERIC NAME & CONTENT AS ABOVE
C     FT06F001 - INCLUDE IF ANY PRINTOUT
C
C REMARKS: LIST CAVEATS, OTHER HELPFUL HINTS OR INFORMATION
C
C ATTRIBUTES:
C   LANGUAGE: F90     
C   MACHINE:  IBM
C
C $$$
C
      DIMENSION ILVLI(3),IFLDI(3),ITAUI(3),IOUTIN(2)
      DIMENSION IIOUT(4,7)
      DIMENSION IFILER(3,3)
      DIMENSION ICODES(3,6)
      DIMENSION ITAU(3,5)
      DIMENSION IFLD(3,3)
      DIMENSION ILVL(3,8)
C
      DATA IBCHK/4H    /
C     DATA LU/8/
      DATA LU/18/
C
C     LEVEL CONTROL TABLE
C
C CHANGED NUMBER OF LEVELS ......
C AND TOOK TROP OUT OF ILVL LIST ......
      DATA    NLVLS/8/
      DATA    ILVL/4H850 ,1H ,1,4H700 ,1H ,2,4H500 ,1H ,3,4H400 ,1H ,4,
     1             4HSFC ,1H ,5,4H250 ,1H ,6,4H200 ,1H ,7,
     2             4H150 ,1H ,8/
C
C     FIELD CONTROL TABLE
C
C CHANGED # OF FIELDS .......
      DATA    NFLDS/3/
      DATA    IFLD/4HU   ,1H ,1,4HV   ,1H ,2,4HTEMP,1HS,3/
C
C     TAU CONTROL TABLE
C
      DATA    NTAUS/5/
      DATA    ITAU/4H18HR,1H ,1,4H24HR,1H ,2,4H00HR,1H ,3,4H36HR,1H ,4,
     1             4H48HR,1H ,5/
C
C     OPERATIONAL RUN TYPE TABLE
C
C CHANGED # OF ICODES .......
      DATA    NCODES/6/
      DATA ICODES/4HOPN0,1H9,1,4HOPN1,1H0,2,4HOPN2,1H6,3,4HOPN2,1H8,4,
     1            4HOPN2,1H5,5,4HOPN3,1H3,6/
C
C     FILE CONTROL TABLE
C
      DATA    NFILES/3/
      DATA    IFILER/4HMERC,1HI,1,4H    ,1H ,2,4HPOLA,1HR,3/
C
C     OUTPUT TYPE CONTROL TABLE
C
      DATA    NOUTS/7/
      DATA    IIOUT/4HS-I ,1H ,1,1,4HS-I-,1HP,2,2,4HS-I-,1HT,3,3,
     1              4HS   ,1H ,4,4,4HP-T-,1HW,5,5,4HP-V ,1H ,6,6,
     2              4HW-T ,1H ,7,7/
C
C     BASIC MAP CONTROLS (SET FOR EACH MAP)
C
C     WHERE ICARD1=          CARD CONTROL(BLANK-A1)
C     WHERE LVL1A,LVL1B=     1ST LEVEL (A4,A1)
C     WHERE IFLD1A,IFLD1B=   1ST FIELD TYPE (A4,A1)
C     WHERE ITAU1A,ITAU1B=   1ST TAU PERIOD (A4,A1)
C     WHERE LVL2A,LVL2B=     2ND LEVEL (A4,A1)
C     WHERE IFLD2A,IFLD2B=   2ND FIELD TYPE (A4,A1)
C     WHERE ITAU2A,ITAU2B=   2ND TAU PERIOD (A4,A1)
C     WHERE LVL3A,LVL3B=     3RD LEVEL (A4,A1)
C     WHERE IFLD3A,IFLD3B=   3RD FIELD TYPE (A4,A1)
C     WHERE ITAU3A,ITAU3B=   3RD TAU PERIOD (A4,A1)
C     WHERE ICODEA,ICODEB=   OPERATIONAL CODE TYPE (A4,A1)
C     WHERE IINFA,IINFB=     INPUT FILE NAME (A4,A1)
C     WHERE IOUTA,IOUTB=     OUTPUT FIELD COMBINATION
C     WHERE MAPON=           MAP NUMBER (I4)
C     WHERE NSLOTS=          NUMBER OF MAP PARTS (I4)
C
 7025 CONTINUE
      IF(ISWTCH.EQ.1) GO TO 7040
C
C     USE DATA CARD INPUT
C
 7030 CONTINUE
Corig READ 7200, ICARD1,LVL1A,LVL1B,IFLD1A,IFLD1B,ITAU1A,ITAU1B,LVL2A,
      READ (LU,7200) ICARD1,LVL1A,LVL1B,IFLD1A,IFLD1B,ITAU1A,ITAU1B,
     1     LVL2A,LVL2B,IFLD2A,IFLD2B,ITAU2A,ITAU2B,LVL3A,LVL3B,IFLD3A,
     2     IFLD3B,ITAU3A,ITAU3B,ICODEA,ICODEB,IINFA,IINFB,IOUTA,
     3     IOUTB,MAPON,NSLOTS
 7200 FORMAT(A1,10(A4,A1),3X,2(A4,A1),2I4)
      GO TO 7045
C
C     USE DATA SET CONTROL FILE INPUT
C
 7040 CONTINUE
      READ(LU,7200) ICARD1,LVL1A,LVL1B,IFLD1A,IFLD1B,ITAU1A,ITAU1B,
     2              LVL2A,LVL2B,IFLD2A,IFLD2B,ITAU2A,ITAU2B,LVL3A,
     3              LVL3B,IFLD3A,IFLD3B,ITAU3A,ITAU3B,ICODEA,
     4              ICODEB,IINFA,IINFB,IOUTA,IOUTB,MAPON,NSLOTS
 7045 CONTINUE
      NUMF=3
      IF(LVL3A.EQ.IBCHK.AND.LVL3B.EQ.IBCHK) NUMF=2
      IF(LVL2A.EQ.IBCHK.AND.LVL2B.EQ.IBCHK.AND.LVL3A.EQ.IBCHK.AND.
     1LVL3B.EQ.IBCHK) NUMF=1
Corig PRINT 7201,MAPON,NUMF
      WRITE(6,7201) MAPON,NUMF
 7201 FORMAT(1H1,'MAP NUMBER=  ',I3,'  NUMBER OF INPUT FIELDS=  ',I3)
Corig PRINT 7202,LVL1A,LVL1B,IFLD1A,IFLD1B,ITAU1A,ITAU1B,LVL2A,LVL2B,
      WRITE(6,7202) LVL1A,LVL1B,IFLD1A,IFLD1B,ITAU1A,ITAU1B,LVL2A,LVL2B,
     1           IFLD2A,IFLD2B,ITAU2A,ITAU2B,LVL3A,LVL3B,IFLD3A,
     2           IFLD3B,ITAU3A,ITAU3B
 7202 FORMAT(1H0,'DATA TYPES=  ',9(A4,A1))
Corig PRINT 7203,ICODEA,ICODEB,IINFA,IINFB,IOUTA,IOUTB,NSLOTS
      WRITE(6,7203) ICODEA,ICODEB,IINFA,IINFB,IOUTA,IOUTB,NSLOTS
 7203 FORMAT(1H0,'OPERATIONAL CODE=  ',A4,A1,'  INPUT FILE=  ',A4,A1,
     X'OUTPUT COMB. TYPE=  ',A4,A1,'  NUMBER OF FAX VARIAN CUTS=  ',I3)
      DO 7210 IX=1,3
      ILVLI(IX)=0
      IFLDI(IX)=0
      ITAUI(IX)=0
 7210 CONTINUE
      ICODIN=0
      INAMIN=0
      DO 7211 IY=1,2
      IOUTIN(IY)=0
 7211 CONTINUE
C
C     CHECK FOR REASONABLE LEVEL REQUESTS
C
C     CHECK LEVEL 1
C
      DO 7215 IK=1,NLVLS
      IF(LVL1A.EQ.IBCHK.AND.LVL1B.EQ.IBCHK) GO TO 7205
      IF(LVL1A.NE.ILVL(1,IK)) GO TO 7215
      IF(LVL1B.NE.ILVL(2,IK)) GO TO 7215
      ILVLI(1)=ILVL(3,IK)
      IP=ILVLI(1)
Corig PRINT 7204,IP
      WRITE(6,7204) IP
 7204 FORMAT(1H0,'LEVEL 1 INDEX FOUND=  ',I2)
      GO TO 7220
C7205 PRINT 7206
 7205 CONTINUE
      WRITE(6,7206)
 7206 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR LEVEL 1-WAS BLANK')
       CALL W3TAGE('AVPOLARV')
      STOP 207
 7215 CONTINUE
Corig PRINT 7216
      WRITE(6,7216)
 7216 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR LEVEL 1')
       CALL W3TAGE('AVPOLARV')
      STOP 217
 7220 CONTINUE
C
C     CHECK LEVEL 2
C
      DO 7235 IK=1,NLVLS
      IF(LVL2A.EQ.IBCHK.AND.LVL2B.EQ.IBCHK) GO TO 7240
      IF(LVL2A.NE.ILVL(1,IK)) GO TO 7235
      IF(LVL2B.NE.ILVL(2,IK)) GO TO 7235
      ILVLI(2)=ILVL(3,IK)
      IP=ILVLI(2)
Corig PRINT 7234,IP
      WRITE(6,7234) IP
 7234 FORMAT(1H0,'LEVEL 2 INDEX FOUND=  ',I2)
      GO TO 7240
 7235 CONTINUE
Corig PRINT 7236
      WRITE(6,7236)
 7236 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR LEVEL 2')
       CALL W3TAGE('AVPOLARV')
      STOP 237
 7240 CONTINUE
C
C     CHECK LEVEL 3
C
      DO 7255 IK=1,NLVLS
      IF(LVL3A.EQ.IBCHK.AND.LVL3B.EQ.IBCHK) GO TO 7260
      IF(LVL3A.NE.ILVL(1,IK)) GO TO 7255
      IF(LVL3B.NE.ILVL(2,IK)) GO TO 7255
      ILVLI(3)=ILVL(3,IK)
      IP=ILVLI(3)
Corig PRINT 7254,IP
      WRITE(6,7254) IP
 7254 FORMAT(1H0,'LEVEL 3 INDEX FOUND=  ',I2)
      GO TO 7260
 7255 CONTINUE
Corig PRINT 7256
      WRITE(6,7256)
 7256 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR LEVEL 3')
       CALL W3TAGE('AVPOLARV')
      STOP 257
 7260 CONTINUE
C
C     CHECK FOR REASONABLE FIELD REQUESTS
C
C     CHECK FIELD 1
C
      DO 7315 IK=1,NFLDS
      IF(IFLD1A.EQ.IBCHK.AND.IFLD1B.EQ.IBCHK) GO TO 7305
      IF(IFLD1A.NE.IFLD(1,IK)) GO TO 7315
      IF(IFLD1B.NE.IFLD(2,IK)) GO TO 7315
      IFLDI(1)=IFLD(3,IK)
      IP=IFLDI(1)
Corig PRINT 7314,IP
      WRITE(6,7314) IP
 7314 FORMAT(1H0,'FIELD 1 INDEX FOUND=  ',I2)
      GO TO 7320
C7305 PRINT 7306
 7305 CONTINUE
      WRITE(6,7306)
 7306 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR FIELD 1-WAS BLANK')
       CALL W3TAGE('AVPOLARV')
      STOP 307
 7315 CONTINUE
Corig PRINT 7316
      WRITE(6,7316)
 7316 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR FIELD1')
       CALL W3TAGE('AVPOLARV')
      STOP 317
 7320 CONTINUE
C
C     CHECK FIELD 2
C
      DO 7335 IK=1,NFLDS
      IF(IFLD2A.EQ.IBCHK.AND.IFLD2B.EQ.IBCHK) GO TO 7340
      IF(IFLD2A.NE.IFLD(1,IK)) GO TO 7335
      IF(IFLD2B.NE.IFLD(2,IK)) GO TO 7335
      IFLDI(2)=IFLD(3,IK)
      IP=IFLDI(2)
Corig PRINT 7334,IP
      WRITE(6,7334) IP
 7334 FORMAT(1H0,'FIELD 2 INDEX FOUND=  ',I2)
      GO TO 7340
 7335 CONTINUE
Corig PRINT 7336
      WRITE(6,7336)
 7336 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR FIELD 2')
       CALL W3TAGE('AVPOLARV')
      STOP 337
 7340 CONTINUE
C
C     CHECK FIELD 3
C
      DO 7355 IK=1,NFLDS
      IF(IFLD3A.EQ.IBCHK.AND.IFLD3B.EQ.IBCHK) GO TO 7360
      IF(IFLD3A.NE.IFLD(1,IK)) GO TO 7355
      IF(IFLD3B.NE.IFLD(2,IK)) GO TO 7355
      IFLDI(3)=IFLD(3,IK)
      IP=IFLDI(3)
Corig PRINT 7354,IP
      WRITE(6,7354) IP
 7354 FORMAT(1H0,'FIELD 3 INDEX FOUND=  ',I2)
      GO TO 7360
 7355 CONTINUE
Corig PRINT 7356
      WRITE(6,7356)
 7356 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR FIELD 3')
       CALL W3TAGE('AVPOLARV')
      STOP 357
 7360 CONTINUE
C
C     CHECK FOR REASONABLE TAU REQUESTS
C
C     CHECK TAU 1
C
      DO 7415 IK=1,NTAUS
      IF(ITAU1A.EQ.IBCHK.AND.ITAU1B.EQ.IBCHK) GO TO 7415
      IF(ITAU1A.NE.ITAU(1,IK)) GO TO 7415
      IF(ITAU1B.NE.ITAU(2,IK)) GO TO 7415
      ITAUI(1)=ITAU(3,IK)
      IP=ITAUI(1)
Corig PRINT 7414,IP
      WRITE(6,7414) IP
 7414 FORMAT(1H0,'TAU 1 INDEX FOUND=  ',I2)
      GO TO 7420
C
 7415 CONTINUE
Corig PRINT 7416
      WRITE(6,7416)
 7416 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR ITAU 1')
       CALL W3TAGE('AVPOLARV')
      STOP 417
 7420 CONTINUE
C
C     CHECK TAU 2
C
      DO 7435 IK=1,NTAUS
      IF(ITAU2A.EQ.IBCHK.AND.ITAU2B.EQ.IBCHK) GO TO 7440
      IF(ITAU2A.NE.ITAU(1,IK)) GO TO 7435
      IF(ITAU2B.NE.ITAU(2,IK)) GO TO 7435
      ITAUI(2)=ITAU(3,IK)
      IP=ITAUI(2)
Corig PRINT 7434,IP
      WRITE(6,7434) IP
 7434 FORMAT(1H0,'TAU 2 INDEX FOUND=  ',I2)
      GO TO 7440
 7435 CONTINUE
Corig PRINT 7436
      WRITE(6,7436)
 7436 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR ITAU 2')
       CALL W3TAGE('AVPOLARV')
      STOP 437
 7440 CONTINUE
C
C     CHECK TAU 3
C
      DO 7455 IK=1,NTAUS
      IF(ITAU3A.EQ.IBCHK.AND.ITAU3B.EQ.IBCHK) GO TO 7460
      IF(ITAU3A.NE.ITAU(1,IK)) GO TO 7455
      IF(ITAU3B.NE.ITAU(2,IK)) GO TO 7455
      ITAUI(3)=ITAU(3,IK)
      IP=ITAUI(3)
Corig PRINT 7454,IP
      WRITE(6,7454) IP
 7454 FORMAT(1H0,'TAU 3 INDEX FOUND=  ',I2)
      GO TO 7460
 7455 CONTINUE
Corig PRINT 7456
      WRITE(6,7456)
 7456 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR ITAU 3')
       CALL W3TAGE('AVPOLARV')
      STOP 457
 7460 CONTINUE
C
C     CHECK FOR REASONABLE OPERATIONAL CODE REQUESTS
C
      DO 7515 IK=1,NCODES
      IF(ICODEA.EQ.IBCHK.AND.ICODEB.EQ.IBCHK) GO TO 7505
      IF(ICODEA.NE.ICODES(1,IK)) GO TO 7515
      IF(ICODEB.NE.ICODES(2,IK)) GO TO 7515
      ICODIN=ICODES(3,IK)
Corig PRINT 7514,ICODIN
      WRITE(6,7514) ICODIN
 7514 FORMAT(1H0,'CODE INDEX FOUND=  ',I2)
      GO TO 7520
C7505 PRINT 7506
 7505 CONTINUE
      WRITE(6,7506)
 7506 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR OPNL CODE-WAS BLANK')
      CALL W3TAGE('AVPOLARV')
      STOP 507
 7515 CONTINUE
Corig PRINT 7516
      WRITE(6,7516)
 7516 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR OPNL CODE')
       CALL W3TAGE('AVPOLARV')
      STOP 517
 7520 CONTINUE
C
C     CHECK FOR REASONABLE FILE REQUESTS
C
      DO 7535 IK=1,NFILES
      IF(IINFA.EQ.IBCHK.AND.IINFB.EQ.IBCHK) GO TO 7525
      IF(IINFA.NE.IFILER(1,IK)) GO TO 7535
      IF(IINFB.NE.IFILER(2,IK)) GO TO 7535
      INAMIN=IFILER(3,IK)
Corig PRINT 7524,INAMIN
      WRITE(6,7524) INAMIN
 7524 FORMAT(1H0,'FILE INDEX FOUND=  ',I2)
      GO TO 7540
C7525 PRINT 7526
 7525 CONTINUE
      WRITE(6,7526)
 7526 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR FILE-WAS BLANK')
       CALL W3TAGE('AVPOLARV')
      STOP 527
 7535 CONTINUE
Corig PRINT 7536
      WRITE(6,7536)
 7536 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR FILE')
       CALL W3TAGE('AVPOLARV')
      STOP 537
 7540 CONTINUE
C
C     CHECK FOR REASONABLE OUTPUT REQUESTS
C
      DO 7555 IK=1,NOUTS
      IF(IOUTA.EQ.IBCHK.AND.IOUTB.EQ.IBCHK) GO TO 7545
      IF(IOUTA.NE.IIOUT(1,IK)) GO TO 7555
      IF(IOUTB.NE.IIOUT(2,IK)) GO TO 7555
      IOUTIN(1)=IIOUT(3,IK)
      IOUTIN(2)=IIOUT(4,IK)
      IP=IOUTIN(1)
      IQ=IOUTIN(2)
Corig PRINT 7554,IP,IQ
      WRITE(6,7554) IP,IQ
 7554 FORMAT(1H0,'OUTPUT TYPE INDEX FOUND=  ',I2,'OUTPUT MAP SET FOUND
     X=  ',I2)
      GO TO 7560
 7545 CONTINUE
Corig PRINT 7546
      WRITE(6,7546)
 7546 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR OUTPUT TYPE-WAS BLANK')
       CALL W3TAGE('AVPOLARV')
CKUMAR      STOP 547
 7555 CONTINUE
Corig PRINT 7556
      WRITE(6,7556)
 7556 FORMAT(1H0,'ERROR ON MAP CONTROL INPUT FOR OUTPUT TYPE')
       CALL W3TAGE('AVPOLARV')
      STOP 557
 7560 CONTINUE
      RETURN
      END
