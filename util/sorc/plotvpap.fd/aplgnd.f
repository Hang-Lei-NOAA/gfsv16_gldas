      SUBROUTINE APLGND(IDUMPT)
C$$$  SUBPROGRAM DOCUMENTATION BLOCK
C                .      .    .                                       .
C SUBPROGRAM:    APLGND      FORM AFOS LEGEND
C   PRGMMR: LILLY            ORG: W/NMC412   DATE: 93-05-06
C
C ABSTRACT: FORM AND PLACES A LEGEND ON THE AFOS PLOTFILE FORMAT.
C
C PROGRAM HISTORY LOG:
C   89-05-10  ORIGINAL AUTHOR HENRICHSEN
C   93-05-06  LILLY CONVERT SUB. TO FORTRAN 77
C
C USAGE:    CALL APLGND(IDUMPT)
C
C   INPUT ARGUMENT LIST:
C     IDUMPT  -  INTEGER   2 WORD ARRAY THAT CONTAINS THE DUMP TIME
C             -  IN HOLLERTH. IE '10+40   '
C     COMMON  -  / DATE /NYR,NMO,NDA,NHR
C
C   OUTPUT ARGUMENT LIST:
C**   COMMON  -  / IFORM/LBLOCK,ICNTOT
C     COMMON  -  / ISPACE/LBLOCK,ICNTOT
C
C   OUTPUT FILES:
C     FT06F001 - STANDARD PRINT FILE.
C
C REMARKS:
C
C ATTRIBUTES:
C   LANGUAGE: FORTRAN 77
C   MACHINE:  NAS
C
C$$$
C
      COMMON / DATE /NYR,NMO,NDA,NHR
C**   COMMON / IFORM/LBLOCK,ICNTOT
      COMMON / ISPACE/LBLOCK,ICNTOT
C
      CHARACTER*12 IBCD
C
C     CHARACTER*4  BLNKL1(06)
C     DATA         BLNKL1      /'1260',',190',',000','00Z,',
C    1                        '    ',Z405E0D0A/
C     CHARACTER*4  BLNKL2(06)
C     DATA         BLNKL2      /'1260',',160',',000','00Z,',
C    1                        '    ',Z405E0D0A/
      INTEGER    YEAR
      INTEGER    ICNTOT
      INTEGER    IDUMPT(2)
      CHARACTER*4  MONAM(12)
      DATA         MONAM       /'JAN ','FEB ','MAR ','APR ',
     1                        'MAY ','JUN ','JUL ','AUG ',
     2                        'SEP ','OCT ','NOV ','DEC '/
      INTEGER    NYR
      INTEGER    JBCD(3)
      INTEGER    NMO
      INTEGER    NDA
      INTEGER    NHR
      INTEGER    IDAYWK
      CHARACTER*4  IHDAYW
      CHARACTER*4  ILEGEN(12)
      DATA         ILEGEN      /'1260',',220',',000','00Z,',
     1                        'HHZ ','THU ','DD A','PR 1',
     2                        '989 ','HH+M','M;  ','    '/
C
      CHARACTER*1 LBLOCK(16384)
      CHARACTER*1 LEGEND(48)
      CHARACTER*1 LVERSN(40)
C
      EQUIVALENCE(ILEGEN(1),LEGEND(1))
      EQUIVALENCE(JBCD(1),IBCD)
C
C     FORM LEGEND FOR AFOS PLOT FILE.
C
      ILEGEN(11)(3:3) = CHAR(13)
      ILEGEN(11)(4:4) = CHAR(10)
C     ..... 0D,0A
C
      YEAR = NYR + 1900
      IF(YEAR .LT. 1950)  YEAR = YEAR + 100
      CALL DAYOWK(NDA,NMO,YEAR,IDAYWK,IHDAYW)
      CALL INT2CH(NHR,IBCD,2,'A999')
      CALL MOVCH(2,JBCD(1),1,LEGEND,17)
      CALL INT2CH(NDA,IBCD,2,'A999')
      CALL MOVCH(2,JBCD(1),1,LEGEND,25)
      CALL INT2CH(YEAR,IBCD,4,'A999')
      CALL MOVCH(4,JBCD(1),1,LEGEND,32)
      CALL MOVCH(4,IHDAYW,1,LEGEND,21)
      CALL MOVCH(4,MONAM(NMO),1,LEGEND,28)
      WRITE(6,2) IDUMPT
 2    FORMAT(' DUMP TIME=',2A4)
      CALL MOVCH(5,IDUMPT,1,LEGEND,37)
C
C     CONVERT LEGEND TO ASC AND LOAD INTO LBLOCK.
C
C???  CALL EB2ASC(44,LEGEND,LBLOCK(ICNTOT),IERR)
      DO I = 1, 44
         LBLOCK(ICNTOT+I-1)=LEGEND(I)
      ENDDO
      ICNTOT = ICNTOT + 44
C
C     PLACE TWO BLANK LINES OF TEXT AFTER LEGEND TO SEE IF THIS
C     FOOL THE PLOTING PROGRAM ON AFOS SO THE THE VERSION TITLE
C     IS PLACED IN UPPER LEFT HAND CORNER OF CHART.
C
C??   CALL EB2ASC(24,BLNKL1,LBLOCK(ICNTOT),IERR)
C??   ICNTOT = ICNTOT + 24
C??   CALL EB2ASC(24,BLNKL2,LBLOCK(ICNTOT),IERR)
C??   ICNTOT = ICNTOT + 24
      RETURN
      END
